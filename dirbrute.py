import requests  # pip install requests
import sys


def brutesoft(urlInput, wordlist):
    # urlInput = http://algo
    try:
        if urlInput[:7] == "http://":
            first = urlInput[:7]  # http://
        elif urlInput[:8] == "https://":
            first = urlInput[:8]  # https://
        second = urlInput[8:]  # www.google.com
        if second[:4] == "www.":
            # first = first + str(second[:4])
            second = second[4:]
        # Domain Verification
        answertest = requests.get(urlInput)
        statustest = answertest.status_code
        if statustest != 400:
            print("{} ==> {}".format(statustest, urlInput), "OK")
        else:
            # print("{} ==> {}".format(statustest, urlInput), "ERROR")
            pass

        for word in wordlist:
            try:
                url_final = "{}/{}".format(urlInput, word)
                answer = requests.get(url_final)
                status = answer.status_code
                #code = answer.text
                if status != 404:
                    print("{} -> {}".format(status, url_final))
                    # print(code)
            except KeyboardInterrupt:
                print("Stoped by User")
                sys.exit(0)
            except Exception:
                pass

        for word in wordlist:
            for word2 in wordlist:
                try:
                    url_final = "{}{}.{}/{}".format(first, word, second, word2)
                    answer = requests.get(url_final)
                    status = answer.status_code
                    # code = answer.text
                    if status != 404:
                        print("{} -> {}".format(url_final, status))
                        # print(code)
                except KeyboardInterrupt:
                    print("Stoped by User")
                    sys.exit(0)
                except:
                    pass

    except KeyboardInterrupt:
        sys.exit(0)
    except requests.RequestException as ce:
        print("CONNECTION ERROR at ({})\n".format(url_final), "\n", ce)
        pass
    except Exception as e:
        print(e)
        pass

def bruteall(urlInput, wordlist):
    # urlInput = http://algo
    try:
        if urlInput[:7] == "http://":
            first = urlInput[:7]  # http://
        elif urlInput[:8] == "https://":
            first = urlInput[:8]  # https://
            second = urlInput[8:]  # www.google.com


        # Domain Verification
        answertest = requests.get(urlInput)
        statustest = answertest.status_code
        if statustest != 400:
            print("{} ==> {}".format(statustest, urlInput), "OK")
        else:
            print("{} ==> {}".format(statustest, urlInput), "ERROR")

        for word in wordlist:
            try:
                url_final = "{}/{}".format(urlInput, word)
                answer = requests.get(url_final)
                status = answer.status_code
                # code = answer.text
                if status != 404:
                    pass
                print("{} -> {}".format(status, url_final))
                # print(code)

            except KeyboardInterrupt:
                print("Stoped by User")
                sys.exit(0)
            except:
                print("Error in ({})".format(url_final))
                pass

        for word in wordlist:
            for word2 in wordlist:
                try:
                    url_final = "{}{}.{}/{}".format(first, word, second, word2)
                    answer = requests.get(url_final)
                    status = answer.status_code
                    # code = answer.text
                    if status != 404:
                        print("{} -> {}".format(url_final, status))
                        # print(code)

                except KeyboardInterrupt:
                    print("Stoped by User")
                    sys.exit(0)

                except:
                    print("Not Reachable ({})".format(url_final))
                    pass

    except KeyboardInterrupt:
        sys.exit(0)
    except requests.RequestException as ce:
        print("CONNECTION ERROR at ({})\n".format(url_final), "\n", ce)
        pass
    except Exception as e:
        print(e)
        pass


if __name__ == "__main__":

    print("Welcome..."
          "\nThis script holds up to 3 sequential arguments"
          "\n1ยบ The host (Ex: https://juice-shop.herokuapp.com/#/)"
          "\n2ยบ The Print Method 'Brutesoft(default) or Bruteall'"
          "\n3ยบ The Wordlist (optional)")

    wordlist = ["g1", "admin", "advanced", "globo", "user", "password", "assets", "pamonha", "CAVALO", "ead" ]
    for param in sys.argv:
        if len(sys.argv) >= 2:
            url = sys.argv[1]

            if len(sys.argv) >= 3:
                if sys.argv[2] == "brutesoft":
                    print("\n\n Using BruteSoft Method")
                    brutesoft(url, wordlist)
                elif sys.argv[2] == "bruteall":
                    print("\n\n Using BruteAll Method")
                    bruteall(url, wordlist)

            if len(sys.argv) >= 4:
                wordlist = sys.argv[3]
                with open(wordlist, 'r') as file:
                    wordlist = file.readlines()


    else:
        url = "https://juice-shop.herokuapp.com/"

    brutesoft(url, wordlist)
    print("Finish")

