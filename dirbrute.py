import requests  # pip install requests
import sys


def brutesoft(urlInput, wordlist):
    # urlInput = http://algo
    try:
        if urlInput[:7] == "http://":
            first = urlInput[:7]  # http://
            second = urlInput[7:]  # www.google.com

        elif urlInput[:8] == "https://":
            first = urlInput[:8]  # https://
            second = urlInput[8:]  # www.google.com
        if second[:4] == "www.":
            # first = first + str(second[:4])
            second = second[4:]
            print(second)
        # Domain Verification
        answertest = requests.get(urlInput)
        statustest = answertest.status_code
        if statustest == 200:
            print("{} ==> {}".format(statustest, urlInput), "OK")
        else:
            print("{} ==> {}".format(statustest, urlInput), "FAILURE")
            pass

        for word in wordlist:
            try:
                url_final = "{}/{}".format(urlInput, word)
                answer = requests.get(url_final)
                status = answer.status_code
                #code = answer.text
                if status >= 199 and status <= 299:
                    print("{} -> {}".format(status, url_final))
                    # print(code)
            except KeyboardInterrupt:
                print("Stoped by User")
                sys.exit(0)
            except Exception:
                pass

        for word in wordlist:
            for word2 in wordlist:
                try:
                    url_final = "{}{}.{}/{}".format(first, word, second, word2)
                    answer = requests.get(url_final)
                    status = answer.status_code
                    # code = answer.text
                    if status >= 199 and status <= 299:
                        print("{} -> {}".format(url_final, status))
                        # print(code)
                except KeyboardInterrupt:
                    print("Stoped by User")
                    sys.exit(0)
                except:
                    pass

    except KeyboardInterrupt:
        sys.exit(0)
    except requests.RequestException as ce:
        print("CONNECTION ERROR at ({})\n".format(url_final), "\n", ce)
        pass
    except Exception as e:
        print(e)
        pass

def bruteall(urlInput, wordlist):
    # urlInput = http://algo
    try:
        if urlInput[:7] == "http://":
            first = urlInput[:7]  # http://
            second = urlInput[7:]  # www.google.com
        elif urlInput[:8] == "https://":
            first = urlInput[:8]  # https://
            second = urlInput[8:]  # www.google.com


        # Domain Verification
        answertest = requests.get(urlInput)
        statustest = answertest.status_code
        if statustest == 200:
            print("{} ==> {}".format(statustest, urlInput), "OK")
        else:
            print("{} ==> {}".format(statustest, urlInput), "FAILURE")
            pass

        for word in wordlist:
            try:
                url_final = "{}/{}".format(urlInput, word)
                answer = requests.get(url_final)
                status = answer.status_code
                # code = answer.text
                if status == round(199, 299):
                    print("{} -> {}".format(status, url_final))
                else:
                    print("{} -> {}".format(status, url_final))
                    # print(code)

            except KeyboardInterrupt:
                print("Stoped by User")
                sys.exit(0)
            except:
                print("Error in ({})".format(url_final))
                pass

        for word in wordlist:
            for word2 in wordlist:
                try:
                    url_final = "{}{}.{}/{}".format(first, word, second, word2)
                    answer = requests.get(url_final)
                    status = answer.status_code
                    # code = answer.text
                    if status != 404:
                        pass
                    print("{} -> {}".format(url_final, status))
                        # print(code)

                except KeyboardInterrupt:
                    print("Stoped by User")
                    sys.exit(0)

                except:
                    print("Not Reachable ({})".format(url_final))
                    pass

    except KeyboardInterrupt:
        sys.exit(0)
    except requests.RequestException as ce:
        print("CONNECTION ERROR at ({})\n".format(url_final), "\n", ce)
        pass
    except Exception as e:
        print(e)
        pass


if __name__ == "__main__":
    try:
        print("Welcome..."
              "\nThis script holds up to 3 sequential arguments"
              "\n1ยบ The host (Ex: https://juice-shop.herokuapp.com/#/)"
              "\n2ยบ The Print Method 'Brutesoft(default) or Bruteall'"
              "\n3ยบ The Wordlist (optional)\n")

        wordlist = ["g1", "admin", "advanced", "globo", "user", "password", "assets", "pamonha", "CAVALO", "ead" ]
        for param in sys.argv:
            if len(sys.argv) >= 2:
                url = sys.argv[1]

                if len(sys.argv) >= 3:
                    if sys.argv[2] == "brutesoft":
                        print("\n\n Using BruteSoft Method")
                        brutesoft(url, wordlist)
                    elif sys.argv[2] == "bruteall":
                        print("\n\n Using BruteAll Method")
                        bruteall(url, wordlist)

                if len(sys.argv) >= 4:
                    wordlist = sys.argv[3]
                    with open(wordlist, 'r') as file:
                        wordlist = file.readlines()

        else:
            url = "http://www.teste.com/"
            urlL = len(url)
            if url[urlL-1:] == "/":
                url = url[:urlL-1]

            brutesoft(url, wordlist)
        print("Finish")
    except Exception as e:
        print(Exception)
